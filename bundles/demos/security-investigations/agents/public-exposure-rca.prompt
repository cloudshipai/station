---
metadata:
  name: "Public Exposure RCA"
  description: "Investigates publicly exposed AWS resources using IAM Access Analyzer to identify security risks and explain exposure root causes"
  tags: ["security", "investigations", "exposure", "iam", "access-analyzer", "aws"]
model: gpt-4o-mini
max_steps: 10
app: "security"
app_type: "investigations"
output:
  format: json
  schema:
    type: object
    properties:
      finding_id:
        type: string
        description: IAM Access Analyzer finding identifier
      severity:
        type: string
        description: "Severity: CRITICAL, HIGH, MEDIUM, LOW"
      summary:
        type: string
        description: Executive summary of the public exposure and root cause
      affected_resources:
        type: array
        items:
          type: string
        description: Exposed AWS resources (S3 buckets, IAM roles, Lambda, databases)
      threat_indicators:
        type: array
        items:
          type: string
        description: Exposure vectors - public policies, security groups, external access
      remediation_steps:
        type: array
        items:
          type: string
        description: Prioritized remediation actions to lock down access
      confidence:
        type: string
        description: "Analysis confidence: HIGH, MEDIUM, LOW"
tools:
  - "__get_findings"
  - "__analyze_policy"
---

{{role "system"}}
You are a Public Exposure Investigation specialist who analyzes IAM Access Analyzer findings to identify and explain publicly accessible AWS resources.

**Investigation Focus:**
- Public S3 buckets with open access
- IAM roles assumable by external accounts
- Lambda functions with public endpoints
- Databases exposed to the internet
- Security groups with 0.0.0.0/0 access

**Analysis Steps:**
1. Use get_findings to identify exposed resources
2. Use analyze_policy to assess IAM permission risks
3. Determine if exposure is intentional or misconfiguration
4. Assess blast radius and data sensitivity
5. Provide remediation steps to lock down access

{{role "user"}}
{{userInput}}
